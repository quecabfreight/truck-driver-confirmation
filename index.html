<script>
    function generateConfirmation() {
        const loadId = document.getElementById('loadId').value.trim();
        const companyName = document.getElementById('companyName').value.trim();
        const driverPhone = document.getElementById('driverPhone').value.trim();
        const dot = document.getElementById('dot').value.trim();
        const startTime = document.getElementById('startTime').value;
        const expirationTime = document.getElementById('expirationTime').value;

        if (!loadId || !companyName || !driverPhone || !dot || !startTime || !expirationTime) {
            alert("Please fill out all fields before generating the confirmation.");
            return;
        }

        const confirmationDetails = `
            <strong>Load ID:</strong> ${loadId}<br>
            <strong>Company Name:</strong> ${companyName}<br>
            <strong>Driver Phone:</strong> ${driverPhone}<br>
            <strong>USDOT#:</strong> ${dot}<br>
            <strong>Start Time:</strong> ${new Date(startTime).toLocaleString()}<br>
            <strong>Expiration Time:</strong> ${new Date(expirationTime).toLocaleString()}
        `;

        document.getElementById('confirmationDetails').innerHTML = confirmationDetails;

        generateQRCode(loadId, companyName, driverPhone, dot, startTime, expirationTime);
        generateSendLinks(loadId, companyName, driverPhone, dot, startTime, expirationTime);
    }

    function generateQRCode(loadId, companyName, driverPhone, dot, startTime, expirationTime) {
        const qrContent = `Load ID: ${loadId}\nCompany: ${companyName}\nPhone: ${driverPhone}\nUSDOT#: ${dot}\nStart: ${startTime}\nExpires: ${expirationTime}`;
        const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?data=${encodeURIComponent(qrContent)}&size=200x200`;

        document.getElementById('qrCode').innerHTML = `<img src="${qrUrl}" alt="QR Code">`;
    }

    function generateSendLinks(loadId, companyName, driverPhone, dot, startTime, expirationTime) {
        const message = `Truck/Driver Confirmation\nLoad ID: ${loadId}\nCompany: ${companyName}\nPhone: ${driverPhone}\nUSDOT#: ${dot}\nStart: ${startTime}\nExpires: ${expirationTime}`;
        const subject = `Truck/Driver Confirmation for Load ${loadId}`;

        const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(message)}`;
        const smsLink = `sms:?body=${encodeURIComponent(message)}`;

        document.getElementById('sendLinks').innerHTML = `
            <a href="${mailtoLink}" class="send-link">Send via Email</a>
            <a href="${smsLink}" class="send-link">Send via Text</a>
        `;
    }
</script>
